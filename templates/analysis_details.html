<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Analysis Details | CareerConnect</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />
  </head>
  <body style="background: #f5f7fb;">
    <div class="container py-4">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h3>Resume Analysis Details</h3>
        <div>
          <a class="btn btn-outline-primary" href="{{ url_for('seeker_dashboard') }}">Back to Dashboard</a>
        </div>
      </div>

      <!-- Role filter removed: role-specific results (if any) are shown below alongside general analysis -->

      <div class="card shadow-sm">
        <div class="card-body">
          {% if analysis %}
            <h4>ATS Score: <span class="text-primary">{{ analysis.ats.ats_score }}</span></h4>
            <hr />
            <p><strong>Extracted skills:</strong> {{ analysis.extracted_skills | join(', ') }}</p>
            {% if role_missing is not none %}
              <p><strong>Missing skills for selected role:</strong> {{ role_missing | join(', ') if role_missing else 'None or no mapping' }}</p>
            {% else %}
              <p><strong>Missing skills:</strong> {{ analysis.ats.missing_skills | join(', ') if analysis.ats.missing_skills else 'None' }}</p>
            {% endif %}
            <p><strong>Predicted roles:</strong> {{ analysis.predicted_roles | join(', ') if analysis.predicted_roles else 'N/A' }}</p>
            <p><strong>Suggestions:</strong></p>
            <ul>
              {% if analysis.suggestions and analysis.suggestions|length > 0 %}
                {% for s in analysis.suggestions %}
                  <li>{{ s }}</li>
                {% endfor %}
              {% else %}
                <li>None</li>
              {% endif %}
            </ul>

            {% if role_missing is not none %}
              <hr />
              <p><strong>Missing skills for selected job:</strong> {{ role_missing | join(', ') if role_missing else 'None or no mapping' }}</p>
            {% endif %}
            {% if role_suggestions %}
              <p><strong>Suggestions for selected role:</strong> {{ role_suggestions | join('; ') }}</p>
            {% endif %}

            <hr />
            <p class="small text-muted">Text length: {{ analysis.text_length }}</p>
          {% else %}
            <p class="text-muted">No analysis available.</p>
          {% endif %}
        </div>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
